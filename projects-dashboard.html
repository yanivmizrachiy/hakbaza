<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="×œ×•×— ×‘×§×¨×” ××ª×§×“× ×œ× ×™×”×•×œ ×¤×¨×•×™×§×˜×™× ×•×¨×™×¤×•×–×™×˜×•×¨×™×•×ª GitHub">
    <meta name="theme-color" content="#667eea">
    <title>×œ×•×— ×‘×§×¨×” - ×¤×¨×•×™×§×˜×™× ×•×¨×™×¤×•×–×™×˜×•×¨×™×•×ª</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #ffffff;
            --text-color: #333;
            --card-bg: #f8f9fa;
            --border-color: #e9ecef;
            --shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --primary-color: #8b9aff;
            --secondary-color: #9d7aff;
            --bg-color: #1a1a2e;
            --text-color: #e0e0e0;
            --card-bg: #16213e;
            --border-color: #2a3a5a;
            --shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-color);
            transition: all 0.3s;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .theme-toggle, .settings-btn, .share-btn, .print-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover, .settings-btn:hover, .share-btn:hover, .print-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        header {
            background: var(--bg-color);
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            transition: all 0.3s;
        }

        .header-top {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.5em;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .subtitle {
            color: var(--text-color);
            opacity: 0.8;
            font-size: 1.2em;
        }

        .controls-panel {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filter-select {
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            background: var(--bg-color);
            color: var(--text-color);
            cursor: pointer;
            min-width: 150px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .stat-item {
            text-align: center;
            padding: 10px 20px;
            background: var(--bg-color);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.9em;
            color: var(--text-color);
            opacity: 0.7;
            margin-top: 5px;
        }

        .last-updated {
            text-align: center;
            margin-top: 15px;
            color: var(--text-color);
            opacity: 0.6;
            font-size: 0.9em;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
        }

        .refresh-btn {
            background: var(--primary-color);
            color: white;
        }

        .refresh-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .refresh-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-export {
            background: #17a2b8;
            color: white;
        }

        .btn-export:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .btn-favorite {
            background: transparent;
            border: 2px solid #ffc107;
            color: #ffc107;
            padding: 8px 12px;
        }

        .btn-favorite.active {
            background: #ffc107;
            color: #333;
        }

        .btn-compare {
            background: #6f42c1;
            color: white;
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .view-btn {
            padding: 8px 15px;
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-color);
        }

        .view-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .category {
            background: var(--bg-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--primary-color);
        }

        .category-title {
            font-size: 1.8em;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-count {
            background: var(--primary-color);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 20px;
        }

        .projects-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .project-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            position: relative;
            cursor: pointer;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }

        .project-card.selected {
            border-color: #6f42c1;
            background: rgba(111, 66, 193, 0.1);
        }

        .project-card.list-view {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .project-card.list-view .project-info {
            flex: 1;
        }

        .project-name {
            font-size: 1.4em;
            color: var(--text-color);
            margin-bottom: 10px;
            font-weight: bold;
        }

        .project-description {
            color: var(--text-color);
            opacity: 0.8;
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .project-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .stat-badge {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: var(--bg-color);
            border-radius: 6px;
            font-size: 0.85em;
            color: var(--text-color);
        }

        .stat-badge .icon {
            font-size: 1.1em;
        }

        .project-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: scale(1.05);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: scale(1.05);
        }

        .btn-info {
            background: #17a2b8;
            color: white;
            padding: 8px 16px;
        }

        .btn-info:hover {
            background: #138496;
            transform: scale(1.05);
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
            padding: 8px 16px;
        }

        .btn-warning:hover {
            background: #e0a800;
            transform: scale(1.05);
        }

        .status-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: bold;
        }

        .status-active {
            background: #28a745;
            color: white;
        }

        .status-archived {
            background: #6c757d;
            color: white;
        }

        .status-experimental {
            background: #ffc107;
            color: #333;
        }

        .favorite-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }

        .favorite-icon:hover {
            transform: scale(1.2);
        }

        .favorite-icon.active {
            color: #ffc107;
        }

        .tech-stack {
            margin-top: 10px;
            font-size: 0.85em;
            color: var(--text-color);
            opacity: 0.7;
        }

        .tech-tag {
            display: inline-block;
            background: var(--bg-color);
            padding: 3px 8px;
            border-radius: 4px;
            margin: 3px 3px 0 0;
        }

        .icon {
            font-size: 1.2em;
            margin-left: 5px;
        }

        .charts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .chart-title {
            font-size: 1.3em;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-color);
            opacity: 0.7;
            font-size: 1.2em;
        }

        .spinner {
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: var(--text-color);
            opacity: 0.7;
            font-size: 1.2em;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: var(--bg-color);
            border-radius: 15px;
            padding: 30px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            position: relative;
            color: var(--text-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 2em;
            color: var(--primary-color);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: var(--text-color);
            opacity: 0.7;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .close-modal:hover {
            background: var(--card-bg);
            opacity: 1;
        }

        .modal-section {
            margin-bottom: 25px;
        }

        .modal-section-title {
            font-size: 1.3em;
            color: var(--primary-color);
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border-color);
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .detail-item {
            padding: 15px;
            background: var(--card-bg);
            border-radius: 8px;
        }

        .detail-label {
            font-size: 0.9em;
            color: var(--text-color);
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.1em;
            font-weight: bold;
            color: var(--text-color);
        }

        .notes-section {
            margin-top: 20px;
        }

        .notes-textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text-color);
            font-family: inherit;
            resize: vertical;
        }

        .notes-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--bg-color);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 2000;
            display: none;
            align-items: center;
            gap: 15px;
            min-width: 300px;
            animation: slideIn 0.3s ease-out;
            color: var(--text-color);
        }

        .notification.active {
            display: flex;
        }

        .notification.success {
            border-right: 4px solid #28a745;
        }

        .notification.info {
            border-right: 4px solid #17a2b8;
        }

        .notification.warning {
            border-right: 4px solid #ffc107;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-icon {
            font-size: 1.5em;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .notification-message {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .close-notification {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            color: var(--text-color);
            opacity: 0.7;
            padding: 0;
        }

        /* Export Menu */
        .export-menu {
            position: relative;
            display: inline-block;
        }

        .export-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--bg-color);
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 100;
            margin-top: 5px;
            min-width: 200px;
        }

        .export-dropdown.active {
            display: block;
        }

        .export-option {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .export-option:last-child {
            border-bottom: none;
        }

        .export-option:hover {
            background: var(--card-bg);
        }

        /* Comparison Mode */
        .comparison-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-color);
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 999;
            display: none;
            align-items: center;
            gap: 15px;
        }

        .comparison-bar.active {
            display: flex;
        }

        .comparison-count {
            background: var(--primary-color);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
        }

        /* Settings Modal */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .setting-item {
            padding: 15px;
            background: var(--card-bg);
            border-radius: 8px;
        }

        .setting-label {
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Offline Indicator */
        .offline-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 2001;
            display: none;
        }

        .offline-indicator.active {
            display: block;
        }

        @media (max-width: 768px) {
            .projects-grid {
                grid-template-columns: 1fr;
            }

            .charts-section {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2em;
            }

            .controls-panel {
                flex-direction: column;
            }

            .search-box, .filter-select {
                width: 100%;
            }

            .modal-content {
                padding: 20px;
            }

            .comparison-bar {
                flex-direction: column;
                width: 90%;
            }
        }

        @media print {
            .controls-panel, .top-bar, .charts-section, .btn, .comparison-bar {
                display: none !important;
            }

            .project-card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="offline-indicator" id="offlineIndicator">
        âš ï¸ ××™×Ÿ ×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜ - ××¦×‘ Offline
    </div>

    <div class="container">
        <div class="top-bar">
            <div style="display: flex; gap: 10px;">
                <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">ğŸŒ™ Dark Mode</button>
                <button class="settings-btn" onclick="showSettings()">âš™ï¸ ×”×’×“×¨×•×ª</button>
                <button class="share-btn" onclick="shareDashboard()">ğŸ“¤ ×©×ª×£</button>
                <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ ×”×“×¤×¡</button>
            </div>
            <div id="favoritesFilter" style="display: none;">
                <button class="btn btn-favorite active" onclick="toggleFavoritesFilter()">â­ ×¨×§ ××•×¢×“×¤×™×</button>
            </div>
        </div>

        <header>
            <div class="header-top">
                <h1>ğŸ¯ ×œ×•×— ×‘×§×¨×” - ×¤×¨×•×™×§×˜×™× ×•×¨×™×¤×•×–×™×˜×•×¨×™×•×ª</h1>
                <p class="subtitle">×¡×§×™×¨×” ××œ××” ×©×œ ×›×œ ×”×¤×¨×•×™×§×˜×™× ×•×”×¨×™×¤×•×–×™×˜×•×¨×™×•×ª ×‘-GitHub</p>
            </div>

            <div class="controls-panel">
                <input type="text" class="search-box" id="searchInput" placeholder="ğŸ” ×—×™×¤×•×© ×¤×¨×•×™×§×˜×™×...">
                <select class="filter-select" id="categoryFilter">
                    <option value="all">×›×œ ×”×§×˜×’×•×¨×™×•×ª</option>
                </select>
                <select class="filter-select" id="statusFilter">
                    <option value="all">×›×œ ×”×¡×˜×˜×•×¡×™×</option>
                    <option value="active">×¤×¢×™×œ</option>
                    <option value="archived">×‘××¨×›×™×•×Ÿ</option>
                    <option value="experimental">× ×™×¡×™×•× ×™</option>
                </select>
                <select class="filter-select" id="sortFilter">
                    <option value="name">××™×•×Ÿ ×œ×¤×™ ×©×</option>
                    <option value="stars">××™×•×Ÿ ×œ×¤×™ ×›×•×›×‘×™×</option>
                    <option value="updated">××™×•×Ÿ ×œ×¤×™ ×¢×“×›×•×Ÿ ××—×¨×•×Ÿ</option>
                    <option value="favorites">××™×•×Ÿ ×œ×¤×™ ××•×¢×“×¤×™×</option>
                </select>
                <div class="view-toggle">
                    <button class="view-btn active" onclick="setView('grid')" id="gridView">âŠ ×¨×©×ª</button>
                    <button class="view-btn" onclick="setView('list')" id="listView">â˜° ×¨×©×™××”</button>
                </div>
                <div class="export-menu">
                    <button class="btn btn-export" onclick="toggleExportMenu()">ğŸ“¥ ×™×™×¦×•×</button>
                    <div class="export-dropdown" id="exportDropdown">
                        <div class="export-option" onclick="exportToJSON()">ğŸ“„ ×™×™×¦×•× ×œ-JSON</div>
                        <div class="export-option" onclick="exportToCSV()">ğŸ“Š ×™×™×¦×•× ×œ-CSV</div>
                        <div class="export-option" onclick="exportToTrello()">ğŸ“‹ ×™×™×¦×•× ×œ-Trello</div>
                    </div>
                </div>
                <button class="btn btn-compare" onclick="toggleCompareMode()" id="compareBtn">ğŸ”€ ×”×©×•×•××”</button>
                <button class="btn refresh-btn" onclick="refreshData()" id="refreshBtn">ğŸ”„ ×¨×¢× ×Ÿ × ×ª×•× ×™×</button>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalProjects">0</div>
                    <div class="stat-label">×¡×”"×› ×¤×¨×•×™×§×˜×™×</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalStars">0</div>
                    <div class="stat-label">â­ ×›×•×›×‘×™×</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalForks">0</div>
                    <div class="stat-label">ğŸ´ Forks</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="activeProjects">0</div>
                    <div class="stat-label">âœ“ ×¤×¢×™×œ×™×</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="favoritesCount">0</div>
                    <div class="stat-label">â­ ××•×¢×“×¤×™×</div>
                </div>
            </div>

            <div class="last-updated">
                ×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”: <span id="updateTime"></span>
            </div>
        </header>

        <div class="charts-section" id="chartsSection">
            <div class="chart-container">
                <div class="chart-title">×¤×™×œ×•×— ×œ×¤×™ ×§×˜×’×•×¨×™×”</div>
                <canvas id="categoryChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">×¤×™×œ×•×— ×œ×¤×™ ×¡×˜×˜×•×¡</div>
                <canvas id="statusChart"></canvas>
            </div>
        </div>

        <div id="content">
            <div class="loading">
                <div class="spinner"></div>
                <div>×˜×•×¢×Ÿ × ×ª×•× ×™×...</div>
            </div>
        </div>
    </div>

    <!-- Comparison Bar -->
    <div class="comparison-bar" id="comparisonBar">
        <span class="comparison-count" id="comparisonCount">0</span>
        <span>×¤×¨×•×™×§×˜×™× × ×‘×—×¨×• ×œ×”×©×•×•××”</span>
        <button class="btn btn-primary" onclick="compareSelected()">×”×©×•×•×”</button>
        <button class="btn" onclick="clearComparison()" style="background: var(--card-bg); color: var(--text-color);">× ×§×”</button>
    </div>

    <!-- Modal for Project Details -->
    <div class="modal" id="projectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">×¤×¨×˜×™ ×¤×¨×•×™×§×˜</h2>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">âš™ï¸ ×”×’×“×¨×•×ª</h2>
                <button class="close-modal" onclick="closeSettings()">&times;</button>
            </div>
            <div class="settings-grid">
                <div class="setting-item">
                    <label class="setting-label">×¢×“×›×•×Ÿ ××•×˜×•××˜×™</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoUpdate" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">×”×ª×¨××•×ª ×¢×œ ×¢×“×›×•× ×™×</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="updateNotifications" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">×©××™×¨×ª ×”×¢×¨×•×ª</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="saveNotes" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">××¦×‘ Offline</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="offlineMode">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="saveSettings()">×©××•×¨ ×”×’×“×¨×•×ª</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon" id="notificationIcon">â„¹ï¸</div>
        <div class="notification-content">
            <div class="notification-title" id="notificationTitle">×”×•×“×¢×”</div>
            <div class="notification-message" id="notificationMessage"></div>
        </div>
        <button class="close-notification" onclick="closeNotification()">&times;</button>
    </div>

    <script>
        let currentView = 'grid';
        let allProjects = [];
        let filteredProjects = [];
        let githubDataCache = {};
        let categoryChart = null;
        let statusChart = null;
        let lastUpdateTimes = {};
        let currentProject = null;
        let favorites = new Set();
        let projectNotes = {};
        let compareMode = false;
        let selectedProjects = new Set();
        let userSettings = {
            autoUpdate: true,
            updateNotifications: true,
            saveNotes: true,
            offlineMode: false,
            theme: 'light'
        };

        // ×˜×¢×™× ×ª × ×ª×•× ×™× ×-localStorage
        function loadCachedData() {
            const cached = localStorage.getItem('githubDataCache');
            if (cached) {
                try {
                    githubDataCache = JSON.parse(cached);
                } catch (e) {
                    console.error('Error loading cache:', e);
                }
            }
            
            const lastUpdates = localStorage.getItem('lastUpdateTimes');
            if (lastUpdates) {
                try {
                    lastUpdateTimes = JSON.parse(lastUpdates);
                } catch (e) {
                    console.error('Error loading update times:', e);
                }
            }

            const favs = localStorage.getItem('favorites');
            if (favs) {
                try {
                    favorites = new Set(JSON.parse(favs));
                } catch (e) {
                    console.error('Error loading favorites:', e);
                }
            }

            const notes = localStorage.getItem('projectNotes');
            if (notes) {
                try {
                    projectNotes = JSON.parse(notes);
                } catch (e) {
                    console.error('Error loading notes:', e);
                }
            }

            const settings = localStorage.getItem('userSettings');
            if (settings) {
                try {
                    userSettings = { ...userSettings, ...JSON.parse(settings) };
                    applySettings();
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
        }

        // ×©××™×¨×ª × ×ª×•× ×™× ×‘-localStorage
        function saveCachedData() {
            try {
                localStorage.setItem('githubDataCache', JSON.stringify(githubDataCache));
                localStorage.setItem('cacheTimestamp', Date.now().toString());
                localStorage.setItem('lastUpdateTimes', JSON.stringify(lastUpdateTimes));
                localStorage.setItem('favorites', JSON.stringify([...favorites]));
                localStorage.setItem('projectNotes', JSON.stringify(projectNotes));
                localStorage.setItem('userSettings', JSON.stringify(userSettings));
            } catch (e) {
                console.error('Error saving cache:', e);
            }
        }

        // Dark Mode
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            userSettings.theme = newTheme;
            saveCachedData();
            document.getElementById('themeToggle').textContent = newTheme === 'dark' ? 'â˜€ï¸ Light Mode' : 'ğŸŒ™ Dark Mode';
        }

        function applySettings() {
            if (userSettings.theme) {
                document.documentElement.setAttribute('data-theme', userSettings.theme);
                document.getElementById('themeToggle').textContent = userSettings.theme === 'dark' ? 'â˜€ï¸ Light Mode' : 'ğŸŒ™ Dark Mode';
            }
            if (document.getElementById('autoUpdate')) {
                document.getElementById('autoUpdate').checked = userSettings.autoUpdate;
            }
            if (document.getElementById('updateNotifications')) {
                document.getElementById('updateNotifications').checked = userSettings.updateNotifications;
            }
            if (document.getElementById('saveNotes')) {
                document.getElementById('saveNotes').checked = userSettings.saveNotes;
            }
            if (document.getElementById('offlineMode')) {
                document.getElementById('offlineMode').checked = userSettings.offlineMode;
            }
        }

        // Offline Detection
        window.addEventListener('online', () => {
            document.getElementById('offlineIndicator').classList.remove('active');
            if (userSettings.autoUpdate) {
                refreshData();
            }
        });

        window.addEventListener('offline', () => {
            document.getElementById('offlineIndicator').classList.add('active');
            showNotification('warning', '××¦×‘ Offline', '××™×Ÿ ×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜');
        });

        // Favorites
        function toggleFavorite(repoName, event) {
            if (event) event.stopPropagation();
            if (favorites.has(repoName)) {
                favorites.delete(repoName);
            } else {
                favorites.add(repoName);
            }
            saveCachedData();
            filterAndSortProjects();
            updateFavoritesCount();
        }

        function toggleFavoritesFilter() {
            const btn = event.target;
            if (btn.classList.contains('active')) {
                btn.classList.remove('active');
                btn.textContent = 'â­ ×¨×§ ××•×¢×“×¤×™×';
            } else {
                btn.classList.add('active');
                btn.textContent = 'â­ ×›×œ ×”×¤×¨×•×™×§×˜×™×';
            }
            filterAndSortProjects();
        }

        function updateFavoritesCount() {
            document.getElementById('favoritesCount').textContent = favorites.size;
        }

        // Comparison Mode
        function toggleCompareMode() {
            compareMode = !compareMode;
            const btn = document.getElementById('compareBtn');
            if (compareMode) {
                btn.classList.add('active');
                btn.style.background = '#28a745';
                showNotification('info', '××¦×‘ ×”×©×•×•××”', '×œ×—×¥ ×¢×œ ×¤×¨×•×™×§×˜×™× ×›×“×™ ×œ×‘×—×•×¨ ××•×ª× ×œ×”×©×•×•××”');
            } else {
                btn.classList.remove('active');
                btn.style.background = '';
                selectedProjects.clear();
                updateComparisonBar();
                renderProjects();
            }
        }

        function selectForComparison(repoName, event) {
            if (event) event.stopPropagation();
            if (!compareMode) return;
            
            if (selectedProjects.has(repoName)) {
                selectedProjects.delete(repoName);
            } else {
                if (selectedProjects.size < 5) {
                    selectedProjects.add(repoName);
                } else {
                    showNotification('warning', '××’×‘×œ×”', '× ×™×ª×Ÿ ×œ×‘×—×•×¨ ×¢×“ 5 ×¤×¨×•×™×§×˜×™× ×œ×”×©×•×•××”');
                    return;
                }
            }
            updateComparisonBar();
            renderProjects();
        }

        function updateComparisonBar() {
            const bar = document.getElementById('comparisonBar');
            const count = document.getElementById('comparisonCount');
            count.textContent = selectedProjects.size;
            
            if (selectedProjects.size > 0) {
                bar.classList.add('active');
            } else {
                bar.classList.remove('active');
            }
        }

        function compareSelected() {
            if (selectedProjects.size < 2) {
                showNotification('warning', '×©×’×™××”', '×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª 2 ×¤×¨×•×™×§×˜×™× ×œ×”×©×•×•××”');
                return;
            }

            const projects = Array.from(selectedProjects).map(name => 
                allProjects.find(p => p.repoName === name || p.name === name)
            ).filter(Boolean);

            let html = '<div class="modal-section"><h3 class="modal-section-title">×”×©×•×•××ª ×¤×¨×•×™×§×˜×™×</h3>';
            html += '<table style="width: 100%; border-collapse: collapse;">';
            html += '<tr><th>×ª×›×•× ×”</th>';
            projects.forEach(p => {
                html += `<th>${p.name}</th>`;
            });
            html += '</tr>';

            const properties = [
                { label: '×›×•×›×‘×™×', prop: 'stars' },
                { label: 'Forks', prop: 'forks' },
                { label: 'Watchers', prop: 'watchers' },
                { label: 'Issues', prop: 'openIssues' },
                { label: '×©×¤×”', prop: 'language' },
                { label: '×¡×˜×˜×•×¡', prop: 'status' }
            ];

            properties.forEach(prop => {
                html += '<tr>';
                html += `<td><strong>${prop.label}</strong></td>`;
                projects.forEach(p => {
                    const value = p[prop.prop] || '×œ× ×–××™×Ÿ';
                    html += `<td>${value}</td>`;
                });
                html += '</tr>';
            });

            html += '</table></div>';
            
            document.getElementById('modalTitle').textContent = '×”×©×•×•××ª ×¤×¨×•×™×§×˜×™×';
            document.getElementById('modalBody').innerHTML = html;
            document.getElementById('projectModal').classList.add('active');
        }

        function clearComparison() {
            selectedProjects.clear();
            updateComparisonBar();
            renderProjects();
        }

        // Share Functionality
        function shareDashboard() {
            if (navigator.share) {
                navigator.share({
                    title: '×œ×•×— ×‘×§×¨×” - ×¤×¨×•×™×§×˜×™×',
                    text: `×¡×”"×› ${allProjects.length} ×¤×¨×•×™×§×˜×™× ×‘-GitHub`,
                    url: window.location.href
                }).catch(err => console.log('Error sharing', err));
            } else {
                const url = window.location.href;
                navigator.clipboard.writeText(url).then(() => {
                    showNotification('success', '×”×•×¢×ª×§', '×”×§×™×©×•×¨ ×”×•×¢×ª×§ ×œ×œ×•×—');
                });
            }
        }

        // Settings
        function showSettings() {
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function saveSettings() {
            userSettings.autoUpdate = document.getElementById('autoUpdate').checked;
            userSettings.updateNotifications = document.getElementById('updateNotifications').checked;
            userSettings.saveNotes = document.getElementById('saveNotes').checked;
            userSettings.offlineMode = document.getElementById('offlineMode').checked;
            saveCachedData();
            showNotification('success', '× ×©××¨', '×”×”×’×“×¨×•×ª × ×©××¨×• ×‘×”×¦×œ×—×”');
            closeSettings();
        }

        // Notes
        function saveNote(repoName, note) {
            if (userSettings.saveNotes) {
                projectNotes[repoName] = note;
                saveCachedData();
            }
        }

        // ×”××©×š ×”×§×•×“ ×”×§×™×™×...
        // (×›×œ ×”×¤×•× ×§×¦×™×•×ª ×”×§×™×™××•×ª × ×©××¨×•×ª ×›×¤×™ ×©×”×Ÿ)

        // ×™×¦×™×¨×ª ×¨×©×™××” ×©×˜×•×—×” ×©×œ ×›×œ ×”×¤×¨×•×™×§×˜×™×
        function flattenProjects() {
            allProjects = [];
            for (const [categoryKey, category] of Object.entries(projectsData)) {
                category.projects.forEach(project => {
                    allProjects.push({
                        ...project,
                        category: categoryKey,
                        categoryTitle: category.title,
                        stars: 0,
                        forks: 0,
                        updated: null,
                        language: null,
                        issues: 0,
                        openIssues: 0,
                        size: 0,
                        defaultBranch: 'main',
                        watchers: 0,
                        license: null,
                        topics: []
                    });
                });
            }
        }

        // ×¢×“×›×•×Ÿ ×§×˜×’×•×¨×™×•×ª ×‘×¤×™×œ×˜×¨
        function updateCategoryFilter() {
            const filter = document.getElementById('categoryFilter');
            filter.innerHTML = '<option value="all">×›×œ ×”×§×˜×’×•×¨×™×•×ª</option>';
            for (const [key, category] of Object.entries(projectsData)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = category.title;
                filter.appendChild(option);
            }
        }

        // ×§×‘×œ×ª × ×ª×•× ×™× ×-GitHub API
        async function fetchGitHubData(repoName) {
            if (userSettings.offlineMode || !navigator.onLine) {
                const cached = githubDataCache[repoName];
                if (cached) return cached.data;
                return null;
            }

            const cacheKey = repoName;
            const cached = githubDataCache[cacheKey];
            if (cached && (Date.now() - cached.timestamp) < 30 * 60 * 1000) {
                return cached.data;
            }

            try {
                const response = await fetch(`https://api.github.com/repos/yanivmizrachiy/${repoName}`, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const oldUpdated = lastUpdateTimes[repoName];
                    const newUpdated = data.updated_at ? new Date(data.updated_at) : null;
                    
                    if (oldUpdated && newUpdated && newUpdated > new Date(oldUpdated) && userSettings.updateNotifications) {
                        showNotification('success', '×¢×“×›×•×Ÿ ×—×“×©!', `×”×¤×¨×•×™×§×˜ ${repoName} ×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”`);
                    }
                    
                    if (newUpdated) {
                        lastUpdateTimes[repoName] = newUpdated.toISOString();
                    }
                    
                    const result = {
                        stars: data.stargazers_count || 0,
                        forks: data.forks_count || 0,
                        updated: newUpdated,
                        language: data.language || null,
                        description: data.description || '',
                        issues: data.open_issues_count || 0,
                        openIssues: data.open_issues_count || 0,
                        size: data.size || 0,
                        defaultBranch: data.default_branch || 'main',
                        createdAt: data.created_at ? new Date(data.created_at) : null,
                        pushedAt: data.pushed_at ? new Date(data.pushed_at) : null,
                        watchers: data.watchers_count || 0,
                        license: data.license ? data.license.name : null,
                        topics: data.topics || []
                    };
                    
                    githubDataCache[cacheKey] = {
                        data: result,
                        timestamp: Date.now()
                    };
                    saveCachedData();
                    
                    return result;
                } else if (response.status === 404) {
                    return { stars: 0, forks: 0, updated: null, language: null, description: '', issues: 0, openIssues: 0, size: 0, defaultBranch: 'main', createdAt: null, pushedAt: null, watchers: 0, license: null, topics: [] };
                }
            } catch (error) {
                console.error(`Error fetching ${repoName}:`, error);
                const cached = githubDataCache[repoName];
                if (cached) return cached.data;
            }
            
            return null;
        }

        // ×¢×“×›×•×Ÿ ×›×œ ×”×¤×¨×•×™×§×˜×™× ×¢× × ×ª×•× ×™ GitHub
        async function updateAllProjectsWithGitHubData() {
            if (userSettings.offlineMode || !navigator.onLine) {
                showNotification('info', '××¦×‘ Offline', '×”× ×ª×•× ×™× × ×˜×¢× ×™× ××”××˜××•×Ÿ');
                return;
            }

            const projectsToUpdate = allProjects.filter(p => p.repoName);
            let updated = 0;
            
            for (const project of projectsToUpdate) {
                const data = await fetchGitHubData(project.repoName);
                if (data) {
                    project.stars = data.stars;
                    project.forks = data.forks;
                    project.updated = data.updated;
                    project.language = data.language;
                    project.issues = data.issues || 0;
                    project.openIssues = data.openIssues || 0;
                    project.size = data.size || 0;
                    project.defaultBranch = data.defaultBranch || 'main';
                    project.createdAt = data.createdAt;
                    project.pushedAt = data.pushedAt;
                    project.watchers = data.watchers || 0;
                    project.license = data.license;
                    project.topics = data.topics || [];
                    if (data.description && !project.description.includes('×¤×¨×•×™×§×˜')) {
                        project.description = data.description;
                    }
                    updated++;
                    
                    if (updated % 5 === 0) {
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }
                }
            }
        }

        function getStatusBadge(status) {
            const badges = {
                active: '<span class="status-badge status-active">âœ“ ×¤×¢×™×œ</span>',
                archived: '<span class="status-badge status-archived">ğŸ“¦ ×‘××¨×›×™×•×Ÿ</span>',
                experimental: '<span class="status-badge status-experimental">ğŸ§ª × ×™×¡×™×•× ×™</span>'
            };
            return badges[status] || '';
        }

        function renderProjects() {
            const content = document.getElementById('content');
            
            if (filteredProjects.length === 0) {
                content.innerHTML = '<div class="no-results">×œ× × ××¦××• ×¤×¨×•×™×§×˜×™× ×”×ª×•×××™× ×œ×—×™×¤×•×©</div>';
                return;
            }

            const grouped = {};
            filteredProjects.forEach(project => {
                if (!grouped[project.category]) {
                    grouped[project.category] = [];
                }
                grouped[project.category].push(project);
            });

            let html = '';

            for (const [categoryKey, projects] of Object.entries(grouped)) {
                const category = projectsData[categoryKey];
                html += `
                    <div class="category">
                        <div class="category-header">
                            <div class="category-title">
                                <span>${category.icon}</span>
                                <span>${category.title}</span>
                                <span class="category-count">${projects.length}</span>
                            </div>
                        </div>
                        <div class="${currentView === 'grid' ? 'projects-grid' : 'projects-list'}">
                `;

                projects.forEach(project => {
                    const repoName = project.repoName || project.name;
                    const isFavorite = favorites.has(repoName);
                    const isSelected = selectedProjects.has(repoName);
                    const updatedText = project.updated 
                        ? `×¢×•×“×›×Ÿ: ${project.updated.toLocaleDateString('he-IL')}`
                        : '';
                    
                    html += `
                        <div class="project-card ${currentView === 'list' ? 'list-view' : ''} ${isSelected ? 'selected' : ''}" 
                             onclick="${compareMode ? `selectForComparison('${repoName}', event)` : `showProjectDetails('${repoName}')`}">
                            ${getStatusBadge(project.status)}
                            <div class="favorite-icon ${isFavorite ? 'active' : ''}" onclick="toggleFavorite('${repoName}', event)">
                                ${isFavorite ? 'â­' : 'â˜†'}
                            </div>
                            <div class="project-info">
                                <div class="project-name">${project.name}</div>
                                <div class="project-description">${project.description}</div>
                                ${project.stars > 0 || project.forks > 0 || project.updated ? `
                                    <div class="project-stats">
                                        ${project.stars > 0 ? `
                                            <div class="stat-badge">
                                                <span class="icon">â­</span>
                                                <span>${project.stars}</span>
                                            </div>
                                        ` : ''}
                                        ${project.forks > 0 ? `
                                            <div class="stat-badge">
                                                <span class="icon">ğŸ´</span>
                                                <span>${project.forks}</span>
                                            </div>
                                        ` : ''}
                                        ${project.language ? `
                                            <div class="stat-badge">
                                                <span class="icon">ğŸ’»</span>
                                                <span>${project.language}</span>
                                            </div>
                                        ` : ''}
                                        ${updatedText ? `
                                            <div class="stat-badge">
                                                <span class="icon">ğŸ•’</span>
                                                <span>${updatedText}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                ` : ''}
                                <div class="project-buttons" onclick="event.stopPropagation()">
                                    <a href="${project.github}" target="_blank" class="btn btn-primary">
                                        <span class="icon">ğŸ“‚</span> GitHub
                                    </a>
                                    ${project.live ? `
                                        <a href="${project.live}" target="_blank" class="btn btn-success">
                                            <span class="icon">ğŸŒ</span> ××ª×¨ ×—×™
                                        </a>
                                    ` : ''}
                                    <button class="btn btn-info" onclick="event.stopPropagation(); showProjectDetails('${repoName}')">
                                        <span class="icon">â„¹ï¸</span> ×¤×¨×˜×™×
                                    </button>
                                </div>
                                ${project.tech && project.tech.length > 0 ? `
                                    <div class="tech-stack">
                                        ${project.tech.map(tech => `<span class="tech-tag">${tech}</span>`).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            }

            content.innerHTML = html;
        }

        function filterAndSortProjects() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const sortBy = document.getElementById('sortFilter').value;
            const favoritesOnly = document.querySelector('.btn-favorite.active');

            filteredProjects = allProjects.filter(project => {
                const repoName = project.repoName || project.name;
                const matchesSearch = !searchTerm || 
                    project.name.toLowerCase().includes(searchTerm) ||
                    project.description.toLowerCase().includes(searchTerm) ||
                    (project.tech && project.tech.some(t => t.toLowerCase().includes(searchTerm)));
                
                const matchesCategory = categoryFilter === 'all' || project.category === categoryFilter;
                const matchesStatus = statusFilter === 'all' || project.status === statusFilter;
                const matchesFavorites = !favoritesOnly || favorites.has(repoName);
                
                return matchesSearch && matchesCategory && matchesStatus && matchesFavorites;
            });

            filteredProjects.sort((a, b) => {
                switch (sortBy) {
                    case 'stars':
                        return (b.stars || 0) - (a.stars || 0);
                    case 'updated':
                        if (!a.updated && !b.updated) return 0;
                        if (!a.updated) return 1;
                        if (!b.updated) return -1;
                        return b.updated - a.updated;
                    case 'favorites':
                        const aFav = favorites.has(a.repoName || a.name);
                        const bFav = favorites.has(b.repoName || b.name);
                        if (aFav === bFav) return a.name.localeCompare(b.name, 'he');
                        return bFav ? 1 : -1;
                    case 'name':
                    default:
                        return a.name.localeCompare(b.name, 'he');
                }
            });

            renderProjects();
            updateStats();
            updateCharts();
        }

        function updateStats() {
            const total = allProjects.length;
            const active = allProjects.filter(p => p.status === 'active').length;
            const totalStars = allProjects.reduce((sum, p) => sum + (p.stars || 0), 0);
            const totalForks = allProjects.reduce((sum, p) => sum + (p.forks || 0), 0);

            document.getElementById('totalProjects').textContent = total;
            document.getElementById('activeProjects').textContent = active;
            document.getElementById('totalStars').textContent = totalStars;
            document.getElementById('totalForks').textContent = totalForks;
            updateFavoritesCount();
        }

        function updateCharts() {
            const categoryCounts = {};
            filteredProjects.forEach(p => {
                categoryCounts[p.categoryTitle] = (categoryCounts[p.categoryTitle] || 0) + 1;
            });

            const statusCounts = {};
            filteredProjects.forEach(p => {
                const statusLabels = {
                    active: '×¤×¢×™×œ',
                    archived: '×‘××¨×›×™×•×Ÿ',
                    experimental: '× ×™×¡×™×•× ×™'
                };
                const label = statusLabels[p.status] || p.status;
                statusCounts[label] = (statusCounts[label] || 0) + 1;
            });

            if (categoryChart) categoryChart.destroy();
            const categoryCtx = document.getElementById('categoryChart');
            categoryChart = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categoryCounts),
                    datasets: [{
                        data: Object.values(categoryCounts),
                        backgroundColor: [
                            '#667eea',
                            '#764ba2',
                            '#f093fb',
                            '#4facfe',
                            '#00f2fe',
                            '#43e97b'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            if (statusChart) statusChart.destroy();
            const statusCtx = document.getElementById('statusChart');
            statusChart = new Chart(statusCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(statusCounts),
                    datasets: [{
                        data: Object.values(statusCounts),
                        backgroundColor: [
                            '#28a745',
                            '#6c757d',
                            '#ffc107'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function setView(view) {
            currentView = view;
            document.getElementById('gridView').classList.toggle('active', view === 'grid');
            document.getElementById('listView').classList.toggle('active', view === 'list');
            renderProjects();
        }

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('he-IL', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('updateTime').textContent = timeString;
        }

        async function refreshData() {
            const btn = document.getElementById('refreshBtn');
            btn.textContent = 'â³ ××¢×“×›×Ÿ...';
            btn.disabled = true;

            updateTime();
            document.getElementById('content').style.opacity = '0.5';
            
            try {
                await updateAllProjectsWithGitHubData();
                filterAndSortProjects();
                if (userSettings.updateNotifications) {
                    showNotification('success', '×¢×“×›×•×Ÿ ×”×•×©×œ×', '×›×œ ×”× ×ª×•× ×™× ×¢×•×“×›× ×• ×‘×”×¦×œ×—×”');
                }
            } catch (error) {
                console.error('Error refreshing data:', error);
                showNotification('warning', '×©×’×™××” ×‘×¢×“×›×•×Ÿ', '××™×¨×¢×” ×©×’×™××” ×‘×¢×ª ×¢×“×›×•×Ÿ ×”× ×ª×•× ×™×');
            } finally {
                document.getElementById('content').style.opacity = '1';
                btn.textContent = 'ğŸ”„ ×¨×¢× ×Ÿ × ×ª×•× ×™×';
                btn.disabled = false;
            }
        }

        // ×¤×•× ×§×¦×™×•×ª Modal
        function showProjectDetails(projectIdentifier) {
            const project = allProjects.find(p => p.repoName === projectIdentifier || p.name === projectIdentifier);
            if (!project) return;

            currentProject = project;
            const repoName = project.repoName || project.name;
            document.getElementById('modalTitle').textContent = project.name;
            
            const modalBody = document.getElementById('modalBody');
            const note = projectNotes[repoName] || '';
            
            modalBody.innerHTML = `
                <div class="modal-section">
                    <h3 class="modal-section-title">ğŸ“ ×ª×™××•×¨</h3>
                    <p>${project.description || '××™×Ÿ ×ª×™××•×¨ ×–××™×Ÿ'}</p>
                </div>

                <div class="modal-section">
                    <h3 class="modal-section-title">ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª</h3>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">â­ ×›×•×›×‘×™×</div>
                            <div class="detail-value">${project.stars || 0}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸ´ Forks</div>
                            <div class="detail-value">${project.forks || 0}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸ‘ï¸ Watchers</div>
                            <div class="detail-value">${project.watchers || 0}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸ› Issues ×¤×ª×•×—×™×</div>
                            <div class="detail-value">${project.openIssues || 0}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸ’» ×©×¤×ª ×ª×›× ×•×ª</div>
                            <div class="detail-value">${project.language || '×œ× ×–××™×Ÿ'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸ“¦ ×’×•×“×œ</div>
                            <div class="detail-value">${project.size ? (project.size / 1024).toFixed(2) + ' MB' : '×œ× ×–××™×Ÿ'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸŒ¿ Branch ×¨××©×™</div>
                            <div class="detail-value">${project.defaultBranch || 'main'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ğŸ“„ ×¨×™×©×™×•×Ÿ</div>
                            <div class="detail-value">${project.license || '×œ× ×–××™×Ÿ'}</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3 class="modal-section-title">ğŸ“… ×ª××¨×™×›×™×</h3>
                    <div class="detail-grid">
                        ${project.createdAt ? `
                            <div class="detail-item">
                                <div class="detail-label">ğŸ“… × ×•×¦×¨ ×‘</div>
                                <div class="detail-value">${project.createdAt.toLocaleDateString('he-IL')}</div>
                            </div>
                        ` : ''}
                        ${project.updated ? `
                            <div class="detail-item">
                                <div class="detail-label">ğŸ•’ ×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”</div>
                                <div class="detail-value">${project.updated.toLocaleDateString('he-IL')}</div>
                            </div>
                        ` : ''}
                        ${project.pushedAt ? `
                            <div class="detail-item">
                                <div class="detail-label">â¬†ï¸ Push ××—×¨×•×Ÿ</div>
                                <div class="detail-value">${project.pushedAt.toLocaleDateString('he-IL')}</div>
                            </div>
                        ` : ''}
                    </div>
                </div>

                ${project.tech && project.tech.length > 0 ? `
                    <div class="modal-section">
                        <h3 class="modal-section-title">ğŸ› ï¸ ×˜×›× ×•×œ×•×’×™×•×ª</h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            ${project.tech.map(tech => `<span class="tech-tag" style="font-size: 1em; padding: 8px 15px;">${tech}</span>`).join('')}
                        </div>
                    </div>
                ` : ''}

                ${project.topics && project.topics.length > 0 ? `
                    <div class="modal-section">
                        <h3 class="modal-section-title">ğŸ·ï¸ × ×•×©××™×</h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            ${project.topics.map(topic => `<span class="tech-tag" style="background: var(--primary-color); color: white;">${topic}</span>`).join('')}
                        </div>
                    </div>
                ` : ''}

                <div class="modal-section notes-section">
                    <h3 class="modal-section-title">ğŸ“ ×”×¢×¨×•×ª ××™×©×™×•×ª</h3>
                    <textarea class="notes-textarea" id="projectNote" placeholder="×”×•×¡×£ ×”×¢×¨×•×ª ×¢×œ ×”×¤×¨×•×™×§×˜...">${note}</textarea>
                    <button class="btn btn-primary" onclick="saveNote('${repoName}', document.getElementById('projectNote').value)" style="margin-top: 10px;">×©××•×¨ ×”×¢×¨×”</button>
                </div>

                <div class="modal-section">
                    <h3 class="modal-section-title">ğŸ”— ×§×™×©×•×¨×™×</h3>
                    <div class="project-buttons">
                        <a href="${project.github}" target="_blank" class="btn btn-primary">
                            <span class="icon">ğŸ“‚</span> GitHub Repository
                        </a>
                        ${project.live ? `
                            <a href="${project.live}" target="_blank" class="btn btn-success">
                                <span class="icon">ğŸŒ</span> ××ª×¨ ×—×™
                            </a>
                        ` : ''}
                        <a href="${project.github}/issues" target="_blank" class="btn btn-warning">
                            <span class="icon">ğŸ›</span> Issues
                        </a>
                        <button class="btn ${favorites.has(repoName) ? 'btn-favorite active' : 'btn-favorite'}" onclick="toggleFavorite('${repoName}'); closeModal(); setTimeout(() => showProjectDetails('${repoName}'), 100);">
                            ${favorites.has(repoName) ? 'â­ ×”×¡×¨ ×××•×¢×“×¤×™×' : 'â˜† ×”×•×¡×£ ×œ××•×¢×“×¤×™×'}
                        </button>
                    </div>
                </div>
            `;

            document.getElementById('projectModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('projectModal').classList.remove('active');
            currentProject = null;
        }

        // ×¤×•× ×§×¦×™×•×ª ×™×™×¦×•×
        function toggleExportMenu() {
            const dropdown = document.getElementById('exportDropdown');
            dropdown.classList.toggle('active');
        }

        function exportToJSON() {
            const data = {
                exportDate: new Date().toISOString(),
                totalProjects: allProjects.length,
                favorites: [...favorites],
                projects: allProjects.map(p => ({
                    name: p.name,
                    description: p.description,
                    category: p.categoryTitle,
                    status: p.status,
                    github: p.github,
                    live: p.live,
                    tech: p.tech,
                    stars: p.stars,
                    forks: p.forks,
                    language: p.language,
                    updated: p.updated ? p.updated.toISOString() : null,
                    issues: p.issues,
                    watchers: p.watchers,
                    license: p.license,
                    note: projectNotes[p.repoName || p.name] || ''
                }))
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `projects-export-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            document.getElementById('exportDropdown').classList.remove('active');
            showNotification('success', '×™×™×¦×•× ×”×•×©×œ×', '×”× ×ª×•× ×™× ×™×•×¦××• ×‘×”×¦×œ×—×” ×œ-JSON');
        }

        function exportToCSV() {
            const headers = ['×©×', '×§×˜×’×•×¨×™×”', '×¡×˜×˜×•×¡', '×ª×™××•×¨', 'GitHub', '××ª×¨ ×—×™', '×›×•×›×‘×™×', 'Forks', '×©×¤×”', '×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”', '×˜×›× ×•×œ×•×’×™×•×ª', '×”×¢×¨×”'];
            const rows = allProjects.map(p => [
                p.name,
                p.categoryTitle,
                p.status,
                p.description || '',
                p.github,
                p.live || '',
                p.stars || 0,
                p.forks || 0,
                p.language || '',
                p.updated ? p.updated.toLocaleDateString('he-IL') : '',
                (p.tech || []).join(', '),
                projectNotes[p.repoName || p.name] || ''
            ]);

            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(','))
            ].join('\n');

            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `projects-export-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            document.getElementById('exportDropdown').classList.remove('active');
            showNotification('success', '×™×™×¦×•× ×”×•×©×œ×', '×”× ×ª×•× ×™× ×™×•×¦××• ×‘×”×¦×œ×—×” ×œ-CSV');
        }

        function exportToTrello() {
            const instructions = `
×”×•×¨××•×ª ×™×™×¦×•× ×œ-Trello:

1. ×¤×ª×— ××ª Trello ×•×™×¦×•×¨ ×œ×•×— ×—×“×© ××• ×‘×—×¨ ×œ×•×— ×§×™×™×
2. ×¦×•×¨ ×¨×©×™××•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª:
   - ğŸŒŸ ×¤×¨×•×™×§×˜ ×¨××©×™
   - ğŸ“š ×¤×¨×•×™×§×˜×™× ×‘×™×ª ×¡×¤×¨×™×™×
   - ğŸ“ ××¤×œ×™×§×¦×™×•×ª ×—×™× ×•×›×™×•×ª
   - ğŸ§ª × ×™×¡×•×™×™× ×•× ×™×¡×™×•× ×•×ª
   - ğŸ“¦ ×¤×¨×•×™×§×˜×™× ×‘××¨×›×™×•×Ÿ
   - ğŸ› ï¸ ×›×œ×™× ×•×©×™×¨×•×ª×™×

3. ×¢×‘×•×¨ ×›×œ ×¤×¨×•×™×§×˜, ×¦×•×¨ ×›×¨×˜×™×¡ ×¢×:
   - ×©× ×”×¤×¨×•×™×§×˜
   - ×ª×™××•×¨
   - ×§×™×©×•×¨ ×œ-GitHub
   - ×ª×’×™×•×ª ×œ×¤×™ ×¡×˜×˜×•×¡ ×•×˜×›× ×•×œ×•×’×™×•×ª

××• ×”×©×ª××© ×‘-Trello API ×œ×”×¢×œ××” ××•×˜×•××˜×™×ª.

${allProjects.length} ×¤×¨×•×™×§×˜×™× ××•×›× ×™× ×œ×™×™×¦×•×.
            `;
            
            alert(instructions);
            document.getElementById('exportDropdown').classList.remove('active');
            showNotification('info', '×”×•×¨××•×ª ×™×™×¦×•×', '×¨××” ××ª ×”×”×•×¨××•×ª ×‘×—×œ×•×Ÿ ×”××™×“×¢');
        }

        // ×¤×•× ×§×¦×™×•×ª ×”×ª×¨××•×ª
        function showNotification(type, title, message) {
            const notification = document.getElementById('notification');
            notification.className = `notification ${type} active`;
            document.getElementById('notificationIcon').textContent = 
                type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationMessage').textContent = message;
            
            setTimeout(() => {
                closeNotification();
            }, 5000);
        }

        function closeNotification() {
            document.getElementById('notification').classList.remove('active');
        }

        // ×¡×’×™×¨×ª modal ×‘×œ×—×™×¦×” ××—×•×¥ ×œ×•
        window.onclick = function(event) {
            const modal = document.getElementById('projectModal');
            if (event.target === modal) {
                closeModal();
            }
            
            const settingsModal = document.getElementById('settingsModal');
            if (event.target === settingsModal) {
                closeSettings();
            }
            
            if (!event.target.closest('.export-menu')) {
                document.getElementById('exportDropdown').classList.remove('active');
            }
        }

        // ××ª×—×•×œ
        document.addEventListener('DOMContentLoaded', async () => {
            loadCachedData();
            flattenProjects();
            updateCategoryFilter();
            
            document.getElementById('searchInput').addEventListener('input', filterAndSortProjects);
            document.getElementById('categoryFilter').addEventListener('change', filterAndSortProjects);
            document.getElementById('statusFilter').addEventListener('change', filterAndSortProjects);
            document.getElementById('sortFilter').addEventListener('change', filterAndSortProjects);

            updateTime();
            filterAndSortProjects();
            
            if (favorites.size > 0) {
                document.getElementById('favoritesFilter').style.display = 'block';
            }
            
            const cacheTimestamp = localStorage.getItem('cacheTimestamp');
            if (!cacheTimestamp || (Date.now() - parseInt(cacheTimestamp)) > 30 * 60 * 1000) {
                if (userSettings.autoUpdate && navigator.onLine) {
                    updateAllProjectsWithGitHubData().then(() => {
                        filterAndSortProjects();
                    });
                }
            } else {
                allProjects.forEach(project => {
                    if (project.repoName && githubDataCache[project.repoName]) {
                        const cached = githubDataCache[project.repoName].data;
                        project.stars = cached.stars;
                        project.forks = cached.forks;
                        project.updated = cached.updated ? new Date(cached.updated) : null;
                        project.language = cached.language;
                        project.issues = cached.issues || 0;
                        project.openIssues = cached.openIssues || 0;
                        project.size = cached.size || 0;
                        project.defaultBranch = cached.defaultBranch || 'main';
                        project.createdAt = cached.createdAt ? new Date(cached.createdAt) : null;
                        project.pushedAt = cached.pushedAt ? new Date(cached.pushedAt) : null;
                        project.watchers = cached.watchers || 0;
                        project.license = cached.license;
                        project.topics = cached.topics || [];
                    }
                });
                filterAndSortProjects();
            }
            
            setInterval(() => {
                updateTime();
                if (userSettings.autoUpdate && navigator.onLine && !userSettings.offlineMode) {
                    updateAllProjectsWithGitHubData().then(() => {
                        filterAndSortProjects();
                    });
                }
            }, 300000);
        });

        // PWA Support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(() => {
                    // Service worker registration failed, continue without it
                });
            });
        }
    </script>
</body>
</html>